# PetQ（ペットキュー）要件定義書

## 1. プロジェクト概要

### 1.1 サービス名

- **サービス名**: ペットキュー（PetQ）
- **プロジェクト名**: PetQ

### 1.2 サービスの目的

- ペット飼育者同士が気軽に情報交換できる場の提供
- 匿名での相談・雑談が可能なスレッド型コミュニティ
- 5 ちゃんねるや Reddit のようなペット特化型掲示板

### 1.3 ターゲットユーザー

- **メインターゲット**: 20-40 代のペット飼育者
- **サブターゲット**: これからペットを飼いたい人
- **対象ペット**: 犬、猫、小動物、鳥、爬虫類など全般

## 2. 機能要件

### 2.1 Phase 1（MVP）機能

#### 2.1.1 スレッド機能

**スレッド作成**

- タイトル：最大 100 文字
- 本文：最大 2000 文字
- カテゴリ：大カテゴリ（動物種別）× サブカテゴリ（内容別）
- 画像：最大 3 枚まで投稿可能

**レス投稿**

- 文字数制限：1000 文字
- 連続投稿制限：同一 IP は 1 分に 1 投稿まで
- アンカー機能：1 つずつのアンカーのみ対応（>>1 形式）
- 画像：最大 3 枚まで投稿可能

#### 2.1.2 カテゴリ構成

**大カテゴリ（動物種別）**

- 犬
- 猫
- 小動物（ハムスター、うさぎ等）
- 鳥
- 爬虫類
- その他

**サブカテゴリ（内容別）**

- 飼育相談
- 病気・健康
- しつけ
- 雑談

#### 2.1.3 検索機能

- キーワード検索
- カテゴリ内検索

#### 2.1.4 お知らせ機能

- トップページに最新 3 件表示
- お知らせ一覧画面
- お知らせ詳細画面
- microCMS で管理

#### 2.1.5 その他の機能

- 人気スレッド表示（レス数順）
- 新着スレッド表示（作成日時順）

### 2.2 Phase 2 機能

- 通報機能
- 管理者用ダッシュボード
- スレッド・レスの削除機能
- Google Analytics 導入

## 3. 非機能要件

### 3.1 データ保持ポリシー

- スレッドの保持期間：無期限
- 1 スレッドの最大レス数：上限なし
- 過去ログ化：なし（無期限保持のため）

### 3.2 SEO・OGP 対策

- 動的 OGP 画像生成（スレッドタイトル表示）
- サイトマップ自動生成
- robots.txt 設定

### 3.3 パフォーマンス最適化

- Next.js の機能を最大限活用（ISR、SSG 等）
- ページネーションによるデータ読み込み
- 画像の遅延読み込み
- Cloudflare CDN 活用

## 4. 技術仕様

### 4.1 技術スタック

**フロントエンド**

- Next.js 14（App Router）
- TypeScript
- Tailwind CSS
- 状態管理：Jotai

**バックエンド**

- Next.js Server Actions
- データベース：Supabase（PostgreSQL）
- 画像保存：Supabase Storage

**インフラ**

- ホスティング：Cloudflare Workers
- CDN：Cloudflare

**外部サービス**

- CMS：microCMS（お知らせ管理）

### 4.2 データベース設計方針

- 読み取り：Supabase クエリビルダーを直接使用
- 書き込み：Supabase RPC（Database Functions）を使用
- Row Level Security（RLS）の活用

### 4.3 主要なデータモデル

```typescript
// スレッド
interface Thread {
  id: string;
  title: string;
  content: string;
  category_id: string;
  sub_category_id: string;
  image_urls?: string[];
  user_ip?: string;
  created_at: Date;
  updated_at: Date;
  response_count: number;
  last_response_at?: Date;
}

// レス
interface Response {
  id: string;
  thread_id: string;
  content: string;
  image_urls?: string[];
  anchor_to?: string;
  user_ip?: string;
  created_at: Date;
}

// カテゴリ
interface Category {
  id: string;
  name: string;
  type: "main" | "sub";
  parent_id?: string;
  display_order: number;
}
```

## 5. UI/UX 設計

### 5.1 デザインコンセプト

- **デザインシステム**: Material Design 3（Material You）
- **特徴**:
  - 角丸を多用した柔らかいデザイン
  - カードベースのレイアウト
  - FAB でスレッド作成

### 5.2 カラーパレット

- Primary: 暖かいオレンジ系（#FF6B35）
- Secondary: 優しいグリーン系（#4ECDC4）
- Background: オフホワイト（#FAFAFA）
- Surface: ホワイト（#FFFFFF）

### 5.3 画面構成

1. トップページ
   - カテゴリ一覧
   - 新着スレッド
   - 人気スレッド
   - お知らせカード（最新 3 件）
2. カテゴリ別スレッド一覧
3. スレッド詳細（レス一覧）
4. スレッド作成画面
5. 検索結果画面
6. お知らせ一覧画面
7. お知らせ詳細画面
8. 利用規約・プライバシーポリシー
9. お問い合わせ

### 5.4 レスポンシブ対応

- スマホ：~768px
- タブレット：768px~1024px
- PC：1024px~
- スマホでの画像表示：タップで拡大

## 6. セキュリティ要件

### 6.1 基本的なセキュリティ対策

- CSRF 対策
- XSS 対策
- SQL インジェクション対策（Supabase RPC 使用）
- 画像アップロードのバリデーション

### 6.2 投稿制限

- 連続投稿制限（同一 IP）
- 画像サイズ制限
- 不適切なコンテンツのフィルタリング（Phase 2）

## 7. 運営ポリシー

### 7.1 投稿ルール

- 個人情報の投稿禁止
- 営利目的の投稿制限
- 虐待や違法行為の禁止
- 医療行為に該当する助言の制限

### 7.2 モデレーション（Phase 2）

- 通報機能の実装
- 管理者による投稿削除
- 悪質ユーザーの IP 制限

## 8. マネタイズ計画

### 8.1 収益化方法

- Google AdSense
- Amazon アフィリエイト
- ペット関連企業の広告（将来的に）

### 8.2 広告配置

- スレッド一覧の間
- スレッド内（5 レスごと）
- サイドバー（PC 版のみ）

## 9. 開発スケジュール

### 9.1 Phase 1（MVP）- 3 ヶ月

1. 環境構築・基本設計（2 週間）
2. データベース設計・構築（1 週間）
3. 基本機能実装（6 週間）
   - スレッド機能
   - カテゴリ機能
   - 検索機能
4. お知らせ機能実装（1 週間）
5. UI/UX ブラッシュアップ（2 週間）
6. テスト・デバッグ（2 週間）

### 9.2 Phase 2 - 1 ヶ月

- 通報機能
- 管理画面
- アナリティクス導入
- 運用改善

## 10. 成功指標（KPI）

### 10.1 初期目標（3 ヶ月）

- 月間アクティブユーザー：1,000 人
- 月間投稿数：500 件
- 月間 PV：10 万 PV

### 10.2 中期目標（1 年）

- 月間アクティブユーザー：10,000 人
- 月間投稿数：5,000 件
- 月間 PV：100 万 PV
- 月間広告収入：10 万円
